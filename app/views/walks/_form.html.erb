<%= form_for @walk do |f| %>
  <div class="errors">
    <%if @walk.errors.any? %>
    <% @waypoint_errors = [] %>
    <% @walk_errors = []%>
      <% @walk.errors.messages.each do |error| %>
        <% if error == @walk.errors.messages[:'waypoints.address'] %>
          <% @waypoint_errors << @walk.errors.messages[:'waypoint.address']%>
        <% elsif error == @walk.errors.messages[:walk]%>
          <% @waypoint_errors << @walk.errors.messages[:walk] %>
        <% else %>
        <% @walk_errors << error %>
        <% end %>
      <% end %>
    <% end %>

    <% if @walk_errors != nil %>
    <%= 'Walk Errors' %>
      <% @walk_errors.each do |key, error| %>
        <ul>
          <li><%= error[0]%> </li>
        </ul>
      <% end %>
    <% end %>

    <% if @waypoint_errors != nil%>
    <%= 'Waypoint Errors' %>
      <% @waypoint_errors.each do |error| %>
        <ul>
          <li><%= error%> </li>
        <ul>
      <% end%>
    <% end %>
  </div>

  <fieldset>
    <div class="create_form_step_one">
    <h3 class="create_step_one_title">Step 1 - Describe Walk</h3>
    <ul>
      <div class ='form_set'>
        <li><%= f.label :city,:class=> 'form_label form_label_create_walk'  %><span class="required">*</span></li>
        <li><%= f.text_field :city, :id=>'autocomplete_centermap', :class=>'form_field form_field_create_walk autocomplete_city'%></li>
        <li><button type="button" id="centerbutton">Center Map on City</button></li>
      </div>
      <div class ='form_set'>
        <li><%= f.label :category, :class=> 'form_label form_label_create_walk' %><span class="required">*</span></li>
        <li><%= f.collection_select(:category_id, Category.all, :id, :theme) %></li>
      </div>
      <div class ='form_set'>
        <li><%= f.label :name,:class=> 'form_label form_label_create_walk'  %><span class="required">*</span></li>
        <li><%= f.text_field :name, :class=>'form_field form_field_create_walk' %></li>
      </div>
      <div class ='form_set'>
        <li><%= f.label :description,:class=> 'form_label form_label_create_walk'  %><span class="required">*</span></li>
        <li><%= f.text_area :description, :class=>'form_field desc_field_create_walk' %></li>
      </div>
      <div class ='form_set'>
        <li><%= f.label :picture,:class=> 'form_label form_label_create_walk'  %></li>
        <li><%= f.file_field :picture, :class=>'form_field form_field_create_walk' %></li>
      </div>
    </div>  <!-- end of create_form_step_one-->

    <div class="create_form_step_two">
      <h3 class="create_step_two_title">Step 2 - Waypoints (Stops)</h3>
      <p class="waypoint_desc">You may create up to 8 Waypoints/Stops for your walk. You can drag the waypoints to your desired order. </p>

      <li>
        <div id="sortable">
          <div id="mkpts">
            <%= f.fields_for :waypoints do |waypoint| %>
            <%= render 'waypoint_fields', :f => waypoint%>
            <% end %>
            <span>Add New Waypoint</span>
              <%= link_to_add_association "+", f, :waypoints, :class=> 'plus' %>
          </div><!-- mkpts div-->
      </li>

      <div>
        <li><button type = 'button' class = 'plot_walk'> plot this walk! </button></li>
        <li><%= f.submit :class=>'walk_submit' %></li>
      </div>
        </div><!-- sortable div -->

      </ul>
    </fieldset>
  </div><!-- end of step two -->
<% end %><!-- end for form for -->
