<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js" ></script>

<div class="page-wrapper">

  <h1 class="create_walk_title">
    Have an awesome path you want to share?</br>
    Create a route!
  </h1>

<div id="map_walk-new" class="map" data-latitude='0' data-longitude="0" ></div>

<div class="form-list">
  <%= form_for @walk do |f| %>

  <div class="errors">
    <%if @walk.errors.any? %>
    <% @waypoint_errors = [] %>
    <% @walk_errors = []%>
      <% @walk.errors.messages.each do |error| %>
        <% if error == @walk.errors.messages[:'waypoints.address'] %>
          <% @waypoint_errors << @walk.errors.messages[:'waypoint.address']%>
        <% elsif error == @walk.errors.messages[:walk]%>
          <% @waypoint_errors << @walk.errors.messages[:walk] %>
        <% else %>
        <% @walk_errors << error %>
        <% end %>
      <% end %>
    <% end%>

    <% if @walk_errors != nil %>
    <%= 'Walk Errors' %>
      <% @walk_errors.each do |key, error| %>
        <ul>
          <li><%= error[0]%> </li>
        </ul>
      <% end %>
    <% end %>

    <% if @waypoint_errors != nil%>
    <%= 'Waypoint Errors' %>
      <% @waypoint_errors.each do |error| %>
        <ul>
          <li><%= error%> </li>
        <ul>
      <% end%>
    <% end %>
  </div>


<div class="create_form_step_one">
  <h3 class="create_step_one_title">Step 1 - Describe Walk</h3>
  <div class ='form_set'>

    <%= f.label :city,:class=> 'form_label form_label_create_walk'  %><span class="required">*  </span>
    <%= f.text_field :city, :id=>'autocomplete_centermap', :class=>'form_field form_field_create_walk autocomplete_city'%>
    <button type="button" id="centerbutton">Center Map on City</button>
  </div>

  <div class ='form_set'>
    <%= f.label :category, :class=> 'form_label form_label_create_walk' %><span class="required">*  </span>
    <%= f.collection_select(:category_id, Category.all, :id, :theme) %>
  </div>

  <div class ='form_set'>
    <%= f.label :name,:class=> 'form_label form_label_create_walk'  %><span class="required">* </span>
    <%= f.text_field :name, :class=>'form_field form_field_create_walk' %>
  </div>

  <div class ='form_set'>
    <%= f.label :description,:class=> 'form_label form_label_create_walk'  %><span class="required">* </span>
    <div><%= f.text_area :description, :class=>'form_field desc_field_create_walk' %></div>
  </div>

  <div class ='form_set'>
    <%= f.label :picture,:class=> 'form_label form_label_create_walk'  %>
    <%= f.file_field :picture, :class=>'form_field form_field_create_walk' %>
  </div>
</div><!-- end of create_form_step_one-->

<div class="create_form_step_two">
    <h3 class="create_step_two_title">Step 2 - Waypoints (Stops)</h3>

    <p class="waypoint_desc">You may create up to 8 Waypoints/Stops for your walk. You can drag the waypoints to your desired order. </p>

<div id="sortable">
  <div id="mkpts">
    <%= f.fields_for :waypoints do |waypoint| %>
    <%= render 'waypoint_fields', :f => waypoint%>
    <% end %>
    <span>Add New Waypoint</span>
      <%= link_to_add_association "+", f, :waypoints, :class=> 'plus' %>
</div><!-- end of create_form_step_two-->

  <div>
    <button type = 'button' class = 'plot_walk'> plot this walk! </button>
    <%= f.submit :class=>'walk_submit' %>
  </div>
</div>

  <% end %><!-- end for form for -->
</div><!-- end of errors -->
  </div><!-- end of form_list -->
</div><!-- end of page wrapper-->
